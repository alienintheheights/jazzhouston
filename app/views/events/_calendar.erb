<link rel="stylesheet" href="/common/js/jquery/css/jquery-ui.css" type="text/css" media="all" />
<script src="/common/js/jquery-ui.min.js" type="text/javascript"></script>
<script type="text/javascript">
    /**
     * On-Ready jQuery block
     */
    $(function() {
        // calendar

        $( "#jh_toolbar" ).datepicker({
            showOn: "button",
            buttonImage: "/common/js/jquery/css/images/calendar.gif",
            buttonImageOnly: false,
            buttonText: 'Pick Date',
            dateFormat: 'yy-mm-dd',
            onSelect : function(date){
                var dateArray = date.split("-");
                window.location = '/events/'+dateArray[0]+'/'+dateArray[1]+'/'+dateArray[2];

            }
        });

        // venue search
        $( "#event_venue_search" ).autocomplete({
            selectFirst: false,
            source: function(request, response) {
                $.ajax({
                    url:"/venues/search_ext",
                    dataType: "json",
                    data: {
                        query: request.term,
                        maxRows: 15
                    },
                    success: function(data) {
                        response($.map(data.results, function(item) {
                            return {
                                label: item.title,
                                value: item.venue_id
                            }
                        }))
                    }
                })
            },
            dataType: 'json',
            minLength: 3,
            select: function( event, ui ) {
                event.preventDefault();
                window.location = '/venues/about/' + ui.item.value;
            }
        });
    });

</script>